import{M as $}from"./bootstrap.esm-8afc01ae.js";import{S as g}from"./sweetalert2.all-4a802743.js";import{T as x}from"./Toast-56ec1d6c.js";import{_ as v,o as r,c as i,a as e,D as _,E as h,K as T,F as O,i as w,t as c,h as L,d as u,n as b,j as f,r as p,b as m,w as M}from"./index-fab5f7f9.js";import{A as V,a as D}from"./AdminMixin-254174d7.js";import"./index-867cc51f.js";const{VITE_APP_URL:U,VITE_APP_PATH:B}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"peihanwang-hexschool",BASE_URL:"/Fangsis/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},R={data(){return{orderEditModal:{},modifyOrder:{create_at:"",id:"",is_paid:!1,num:"",paid_date:"",products:{},total:"",user:{address:"",email:"",name:"",tel:""}},orderCreateAt:""}},props:["tempOrder","editModalIsShow","closeModal","getOrders"],watch:{editModalIsShow(){this.editModalIsShow&&(this.orderEditModal.show(),this.modifyOrder=JSON.parse(JSON.stringify(this.tempOrder)),this.orderCreateAt=new Date(this.modifyOrder.create_at*1e3).toLocaleString())}},methods:{updateOrder(){this.$http.put(`${U}/v2/api/${B}/admin/order/${this.modifyOrder.id}`,{data:this.modifyOrder}).then(d=>{this.getOrders(),this.orderEditModal.hide(),x.fire({icon:"success",title:"已成功更新訂單"})}).catch(d=>{this.orderEditModal.hide(),g.fire({title:"更新訂單失敗失敗",text:"請確認網路連線環境並再次嘗試!",icon:"error",confirmButtonText:"確定",confirmButtonColor:"#5D7067",customClass:{popup:"radius0",confirmButton:"radius0"}})})}},mounted(){this.orderEditModal=new $(this.$refs.orderEditModal),this.$refs.orderEditModal.addEventListener("hidden.bs.modal",d=>{this.closeModal("edit")})}},H={id:"orderEditModal",ref:"orderEditModal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderEditModal","aria-hidden":"true"},N={class:"modal-dialog modal-xl"},F={class:"modal-content border-0"},j=e("div",{class:"modal-header bg-primary text-white"},[e("h5",{id:"productModalLabel",class:"modal-title"},[e("span",null,"編輯訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),J={key:0,class:"modal-body"},q=e("h4",{class:"fw-bold"},"訂單狀態",-1),z=e("hr",null,null,-1),K={class:"row mb-6"},G={class:"col-lg-4"},Q={class:"mb-4"},W=e("label",{for:"orderId",class:"form-label"},"訂單編號",-1),X={class:"col-lg-4"},Y={class:"mb-4"},Z=e("label",{for:"orderCreateAt",class:"form-label"},"訂單成立時間",-1),ee={class:"col-lg-4"},te={class:"mb-4"},se=e("label",{for:"orderIsPaid",class:"form-label"},"付款狀態",-1),oe=e("option",{value:!0},"已付款",-1),de=e("option",{value:!1},"未付款",-1),le=[oe,de],re=e("h4",{class:"fw-bold"},"訂購人個人資料",-1),ie=e("hr",null,null,-1),ne={class:"row mb-6"},ae={class:"col-lg-4"},ce={class:"mb-3"},_e=e("label",{for:"orderName",class:"form-label"},"訂購人姓名",-1),he={class:"col-lg-4"},me={class:"mb-3"},ue=e("label",{for:"orderTel",class:"form-label"},"連絡電話",-1),pe={class:"col-lg-4"},be={class:"mb-3"},fe=e("label",{for:"orderEmail",class:"form-label"},"電子郵件",-1),ge={class:"col-12"},Oe={class:"mb-3"},ve=e("label",{for:"orderAddress",class:"form-label"},"收件地址",-1),ye={class:"col-12"},Me={class:"mb-3"},xe=e("label",{for:"orderMessage",class:"form-label"},"訂購人備註",-1),we=e("h4",{class:"fw-bold"},"訂單商品",-1),Pe=e("hr",null,null,-1),Ae={class:"mb-10"},Ee={class:"table-responsive mb-3"},$e={class:"table"},Ce=e("thead",null,[e("tr",{class:"text-nowrap"},[e("th",null,"商品類別"),e("th",null,"商品名稱"),e("th",{class:"text-center"},"使用優惠碼"),e("th",{class:"text-center"},"數量"),e("th",{class:"text-center"},"小計")])],-1),Ie={class:"text-nowrap"},ke={class:"text-center"},Se={key:0},Te={key:1},Le={class:"text-center"},Ve={class:"text-center"},De={class:"text-end me-2"},Ue={class:"modal-footer"},Be=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Re(d,t,a,y,o,l){return r(),i("div",H,[e("div",N,[e("div",F,[j,o.modifyOrder?(r(),i("div",J,[q,z,e("div",K,[e("div",G,[e("div",Q,[W,_(e("input",{id:"orderId",type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=s=>o.modifyOrder.id=s),disabled:""},null,512),[[h,o.modifyOrder.id]])])]),e("div",X,[e("div",Y,[Z,_(e("input",{id:"orderCreateAt",type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=s=>o.orderCreateAt=s),disabled:""},null,512),[[h,o.orderCreateAt]])])]),e("div",ee,[e("div",te,[se,_(e("select",{id:"orderIsPaid",class:"form-select","onUpdate:modelValue":t[2]||(t[2]=s=>o.modifyOrder.is_paid=s)},le,512),[[T,o.modifyOrder.is_paid]])])])]),re,ie,e("div",ne,[e("div",ae,[e("div",ce,[_e,_(e("input",{id:"orderName",type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>o.modifyOrder.user.name=s)},null,512),[[h,o.modifyOrder.user.name]])])]),e("div",he,[e("div",me,[ue,_(e("input",{id:"orderTel",type:"tel",class:"form-control",onkeyup:"value=value.replace(/[^\\d]/g,'') ","onUpdate:modelValue":t[4]||(t[4]=s=>o.modifyOrder.user.tel=s)},null,512),[[h,o.modifyOrder.user.tel]])])]),e("div",pe,[e("div",be,[fe,_(e("input",{id:"Email",type:"email",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=s=>o.modifyOrder.user.email=s)},null,512),[[h,o.modifyOrder.user.email]])])]),e("div",ge,[e("div",Oe,[ve,_(e("input",{id:"orderAddress",type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=s=>o.modifyOrder.user.address=s)},null,512),[[h,o.modifyOrder.user.address]])])]),e("div",ye,[e("div",Me,[xe,_(e("textarea",{id:"orderMessage",type:"text",class:"form-control",rows:"4","onUpdate:modelValue":t[7]||(t[7]=s=>o.modifyOrder.message=s)},`\r
                `,512),[[h,o.modifyOrder.message]])])])]),we,Pe,e("div",Ae,[e("div",Ee,[e("table",$e,[Ce,e("tbody",null,[(r(!0),i(O,null,w(o.modifyOrder.products,s=>(r(),i("tr",{key:s.id},[e("td",null,c(s.product.category),1),e("td",Ie,c(s.product.title),1),e("td",ke,[s.coupon?(r(),i("span",Se,c(s.coupon.title),1)):(r(),i("span",Te,"無使用"))]),e("td",Le,c(s.qty),1),e("td",Ve,c(s.final_total),1)]))),128))])])]),e("p",De,"訂單總金額 : "+c(o.modifyOrder.total),1)]),e("div",Ue,[Be,e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=(...s)=>l.updateOrder&&l.updateOrder(...s))},"確認修改")])])):L("",!0)])])],512)}const He=v(R,[["render",Re]]),{VITE_APP_URL:A,VITE_APP_PATH:E}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"peihanwang-hexschool",BASE_URL:"/Fangsis/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ne={data(){return{deleteOrderModal:{}}},props:["tempOrder","deleteModalIsShow","closeModal","getOrders"],watch:{deleteModalIsShow(){this.deleteModalIsShow&&this.deleteOrderModal.show()}},methods:{deleteOrder(){this.$http.delete(`${A}/v2/api/${E}/admin/order/${this.tempOrder.id}`).then(d=>{this.getOrders(),this.deleteOrderModal.hide(),x.fire({icon:"success",title:"已成功刪除訂單"})}).catch(d=>{this.deleteOrderModal.hide(),g.fire({title:"刪除訂單失敗",text:"請確認網路連線環境並再次嘗試!",icon:"error",confirmButtonText:"確定",confirmButtonColor:"#5D7067",customClass:{popup:"radius0",confirmButton:"radius0"}})})},deleteAllOrder(){this.$http.delete(`${A}/v2/api/${E}/admin/orders/all`).then(d=>{this.getOrders(),this.deleteOrderModal.hide(),x.fire({icon:"success",title:"已成功刪除全部訂單"})}).catch(d=>{this.deleteOrderModal.hide(),g.fire({title:"刪除訂單失敗",text:"請確認網路連線環境並再次嘗試!",icon:"error",confirmButtonText:"確定",confirmButtonColor:"#5D7067",customClass:{popup:"radius0",confirmButton:"radius0"}})})}},mounted(){this.deleteOrderModal=new $(this.$refs.deleteOrderModal),this.$refs.deleteOrderModal.addEventListener("hidden.bs.modal",d=>{this.closeModal("delete")})}},Fe={id:"deleteOrderModal",ref:"deleteOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"deleteOrderModal","aria-hidden":"true"},je={class:"modal-dialog"},Je={class:"modal-content border-0"},qe=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ze={class:"modal-body"},Ke={class:"text-danger"},Ge={class:"modal-footer"},Qe=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function We(d,t,a,y,o,l){return r(),i("div",Fe,[e("div",je,[e("div",Je,[qe,e("div",ze,[u(" 是否刪除 "),e("strong",Ke,c(a.tempOrder.id),1),u(" 訂單 ( 刪除後將無法恢復 )。 ")]),e("div",Ge,[Qe,a.tempOrder.id==="全部"?(r(),i("button",{key:0,type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...s)=>l.deleteAllOrder&&l.deleteAllOrder(...s))}," 確認刪除 ")):(r(),i("button",{key:1,type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=(...s)=>l.deleteOrder&&l.deleteOrder(...s))},"確認刪除"))])])])],512)}const Xe=v(Ne,[["render",We]]),Ye={data(){return{}},props:["pages","getOrders"]},Ze={"aria-label":"Page navigation example"},et={class:"pagination"},tt=e("span",{"aria-hidden":"true"},"«",-1),st=[tt],ot=["onClick"],dt=e("span",{"aria-hidden":"true"},"»",-1),lt=[dt];function rt(d,t,a,y,o,l){return r(),i("nav",Ze,[e("ul",et,[e("li",{class:b(["page-item",{disabled:!a.pages.has_pre}])},[e("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=f(s=>a.getOrders(a.pages.current_page-1),["prevent"]))},st)],2),(r(!0),i(O,null,w(a.pages.total_pages,s=>(r(),i("li",{class:b(["page-item",{active:s===a.pages.current_page}]),key:s+"page"},[e("a",{class:"page-link",href:"#",onClick:f(P=>a.getOrders(s),["prevent"])},c(s),9,ot)],2))),128)),e("li",{class:b(["page-item",{disabled:!a.pages.has_next}])},[e("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=f(s=>a.getOrders(a.pages.current_page+1),["prevent"]))},lt)],2)])])}const it=v(Ye,[["render",rt]]),{VITE_APP_URL:nt,VITE_APP_PATH:at}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"peihanwang-hexschool",BASE_URL:"/Fangsis/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},ct={data(){return{orders:[],tempOrder:{},pages:{},editModalIsShow:!1,deleteModalIsShow:!1,container:this.$refs.orderLoadingContainer}},components:{OrderEditModal:He,OrderDeleteModal:Xe,OrderPagination:it,AdminContainerLoading:V},mixins:[D],methods:{getOrders(d=1){this.isLoading=!0,this.$http.get(`${nt}/v2/api/${at}/admin/orders?page=${d}`).then(t=>{this.orders=t.data.orders,this.pages=t.data.pagination,this.isLoading=!1}).catch(t=>{g.fire({title:"資料錯誤",text:"無法取得後台資料，請重新確認網路連線並重新登入!",icon:"error",confirmButtonText:"確定",confirmButtonColor:"#5D7067",customClass:{popup:"radius0",confirmButton:"radius0"}}),this.isLoading=!1})},openModal(d,t){d==="edit"?(this.editModalIsShow=!0,this.tempOrder={...t}):d==="delete"?(this.deleteModalIsShow=!0,this.tempOrder={...t}):d==="deleteAll"&&(this.deleteModalIsShow=!0,this.tempOrder={id:"全部"})},closeModal(d){d==="edit"?this.editModalIsShow=!1:d==="delete"&&(this.deleteModalIsShow=!1)}},mounted(){this.getOrders()}},_t={class:"d-flex"},ht={class:"sidebar bg-primary",style:{"min-height":"110vh"}},mt=e("h2",{class:"fs-5 text-white py-3 px-3"},"Fangsis 後台管理系統",-1),ut={class:"list-group rounded-0"},pt=e("i",{class:"bi bi-box-seam-fill me-2"},null,-1),bt=e("i",{class:"bi bi-box-seam-fill me-2"},null,-1),ft=e("i",{class:"bi bi-box-seam-fill me-2"},null,-1),gt={class:"main"},Ot={class:"bg-white border-bottom w-100 d-flex justify-content-between"},vt=e("i",{class:"bi bi-arrows-angle-expand"},null,-1),yt=[vt],Mt=e("i",{class:"bi bi-door-open me-2"},null,-1),xt={class:"container py-4 px-4"},wt={class:"border d-flex justify-content-between py-5 px-4 mb-3"},Pt=e("h3",null,"訂單管理",-1),At={class:"border py-5 px-4 mb-5 d-flex flex-column"},Et={class:"vl-parent",ref:"orderLoadingContainer"},$t={class:"table-responsive mb-3"},Ct={class:"table"},It=e("thead",null,[e("tr",{class:"text-nowrap"},[e("th",{scope:"col",class:"text-break"},"訂單編號"),e("th",{scope:"col"},"付款狀態"),e("th",{scope:"col"},"訂購人姓名"),e("th",{scope:"col"},"連絡電話"),e("th",{scope:"col"},"聯絡信箱"),e("th",{scope:"col"},"收件地址"),e("th",{scope:"col"},"訂單成立時間"),e("th",{scope:"col"},"編輯資料")])],-1),kt={key:0,class:"text-success"},St={key:1,class:"text-danger"},Tt={class:"btn-group text-nowrap"},Lt=["onClick"],Vt=["onClick"],Dt={class:"d-flex justify-content-center"};function Ut(d,t,a,y,o,l){const s=p("router-link"),P=p("AdminContainerLoading"),C=p("OrderPagination"),I=p("OrderEditModal"),k=p("OrderDeleteModal");return r(),i(O,null,[e("div",{class:b({"sidebar-toggled":d.sidebarToggledStatus})},[e("div",_t,[e("aside",ht,[mt,e("div",ut,[m(s,{to:"/admin/AdminProducts",class:"list-group-item bg-primary link-light border-0"},{default:M(()=>[pt,u("產品管理 ")]),_:1}),m(s,{to:"/admin/AdminOrders",class:"list-group-item list-group-item-active bg-primary link-light border-0"},{default:M(()=>[bt,u("訂單管理 ")]),_:1}),m(s,{to:"/admin/AdminCoupons",class:"list-group-item bg-primary link-light border-0"},{default:M(()=>[ft,u("優惠卷管理 ")]),_:1})])]),e("main",gt,[e("div",Ot,[e("a",{onClick:t[0]||(t[0]=f((...n)=>d.sidebarToggled&&d.sidebarToggled(...n),["prevent"])),href:"",class:"py-3 px-4 d-inline-block border-end"},yt),e("button",{onClick:t[1]||(t[1]=(...n)=>d.adminLogout&&d.adminLogout(...n)),class:"btn btn-primary text-end my-2 me-3"},[Mt,u("登出 ")])]),e("div",xt,[e("div",wt,[Pt,e("button",{class:"btn btn-outline-primary",onClick:t[2]||(t[2]=n=>l.openModal("deleteAll")),type:"button"}," 刪除全部訂單 ")]),e("div",At,[e("div",Et,[m(P,{isLoading:d.isLoading,container:o.container},null,8,["isLoading","container"]),e("div",$t,[e("table",Ct,[It,e("tbody",null,[(r(!0),i(O,null,w(o.orders,n=>(r(),i("tr",{key:n.id},[e("td",null,c(n.id),1),e("td",null,[n.is_paid?(r(),i("span",kt,"已付款")):(r(),i("span",St,"未付款"))]),e("td",null,c(n.user.name),1),e("td",null,c(n.user.tel),1),e("td",null,c(n.user.email),1),e("td",null,c(n.user.address),1),e("td",null,c(new Date(n.create_at*1e3).toLocaleString()),1),e("td",null,[e("div",Tt,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:S=>l.openModal("edit",n)}," 編輯 ",8,Lt),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:S=>l.openModal("delete",n)}," 刪除 ",8,Vt)])])]))),128))])])]),e("div",Dt,[m(C,{pages:o.pages,getOrders:l.getOrders},null,8,["pages","getOrders"])])],512)])])])])],2),m(I,{tempOrder:o.tempOrder,editModalIsShow:o.editModalIsShow,closeModal:l.closeModal,getOrders:l.getOrders},null,8,["tempOrder","editModalIsShow","closeModal","getOrders"]),m(k,{tempOrder:o.tempOrder,deleteModalIsShow:o.deleteModalIsShow,closeModal:l.closeModal,getOrders:l.getOrders},null,8,["tempOrder","deleteModalIsShow","closeModal","getOrders"])],64)}const Jt=v(ct,[["render",Ut]]);export{Jt as default};
