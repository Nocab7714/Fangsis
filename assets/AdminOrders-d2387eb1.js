import{M as $}from"./bootstrap.esm-ab0895c3.js";import{_ as O,o as l,c as i,a as e,D as _,E as h,M as S,F as f,i as M,t as n,h as C,d as u,n as b,j as g,r as p,b as m,w as y}from"./index-d8e2e5db.js";import{A as V,a as L}from"./AdminMixin-16710098.js";import"./index-bd4575b3.js";const{VITE_APP_URL:T,VITE_APP_PATH:U}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"peihanwang-hexschool",BASE_URL:"/Fangsis/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},D={data(){return{orderEditModal:{},modifyOrder:{create_at:"",id:"",is_paid:!1,num:"",paid_date:"",products:{},total:"",user:{address:"",email:"",name:"",tel:""}},orderCreateAt:""}},props:["tempOrder","editModalIsShow","closeModal","getOrders"],watch:{editModalIsShow(){this.editModalIsShow&&(this.orderEditModal.show(),this.modifyOrder=JSON.parse(JSON.stringify(this.tempOrder)),this.orderCreateAt=new Date(this.modifyOrder.create_at*1e3).toLocaleString())}},methods:{updateOrder(){this.$http.put(`${T}/v2/api/${U}/admin/order/${this.modifyOrder.id}`,{data:this.modifyOrder}).then(o=>{this.getOrders(),this.orderEditModal.hide(),alert(o.data.message)}).catch(o=>{alert(o)})}},mounted(){this.orderEditModal=new $(this.$refs.orderEditModal),this.$refs.orderEditModal.addEventListener("hidden.bs.modal",o=>{this.closeModal("edit")})}},R={id:"orderEditModal",ref:"orderEditModal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderEditModal","aria-hidden":"true"},H={class:"modal-dialog modal-xl"},N={class:"modal-content border-0"},B=e("div",{class:"modal-header bg-primary text-white"},[e("h5",{id:"productModalLabel",class:"modal-title"},[e("span",null,"編輯訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),F={key:0,class:"modal-body"},j=e("h4",{class:"fw-bold"},"訂單狀態",-1),J=e("hr",null,null,-1),q={class:"row mb-6"},z={class:"col-lg-4"},G={class:"mb-4"},K=e("label",{for:"orderId",class:"form-label"},"訂單編號",-1),Q={class:"col-lg-4"},W={class:"mb-4"},X=e("label",{for:"orderCreateAt",class:"form-label"},"訂單成立時間",-1),Y={class:"col-lg-4"},Z={class:"mb-4"},ee=e("label",{for:"orderIsPaid",class:"form-label"},"付款狀態",-1),te=e("option",{value:!0},"已付款",-1),se=e("option",{value:!1},"未付款",-1),oe=[te,se],de=e("h4",{class:"fw-bold"},"訂購人個人資料",-1),le=e("hr",null,null,-1),ie={class:"row mb-6"},re={class:"col-lg-4"},ae={class:"mb-3"},ne=e("label",{for:"orderName",class:"form-label"},"訂購人姓名",-1),ce={class:"col-lg-4"},_e={class:"mb-3"},he=e("label",{for:"orderTel",class:"form-label"},"連絡電話",-1),me={class:"col-lg-4"},ue={class:"mb-3"},pe=e("label",{for:"orderEmail",class:"form-label"},"電子郵件",-1),be={class:"col-12"},ge={class:"mb-3"},fe=e("label",{for:"orderAddress",class:"form-label"},"收件地址",-1),Oe={class:"col-12"},ve={class:"mb-3"},ye=e("label",{for:"orderMessage",class:"form-label"},"訂購人備註",-1),Me=e("h4",{class:"fw-bold"},"訂單商品",-1),xe=e("hr",null,null,-1),we={class:"mb-10"},Pe={class:"table-responsive mb-3"},$e={class:"table"},Ae=e("thead",null,[e("tr",{class:"text-nowrap"},[e("th",null,"商品類別"),e("th",null,"商品名稱"),e("th",{class:"text-center"},"使用優惠碼"),e("th",{class:"text-center"},"數量"),e("th",{class:"text-center"},"小計")])],-1),Ee={class:"text-nowrap"},Ie={class:"text-center"},ke={key:0},Se={key:1},Ce={class:"text-center"},Ve={class:"text-center"},Le={class:"text-end me-2"},Te={class:"modal-footer"},Ue=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function De(o,t,r,v,d,a){return l(),i("div",R,[e("div",H,[e("div",N,[B,d.modifyOrder?(l(),i("div",F,[j,J,e("div",q,[e("div",z,[e("div",G,[K,_(e("input",{id:"orderId",type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=s=>d.modifyOrder.id=s),disabled:""},null,512),[[h,d.modifyOrder.id]])])]),e("div",Q,[e("div",W,[X,_(e("input",{id:"orderCreateAt",type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=s=>d.orderCreateAt=s),disabled:""},null,512),[[h,d.orderCreateAt]])])]),e("div",Y,[e("div",Z,[ee,_(e("select",{id:"orderIsPaid",class:"form-select","onUpdate:modelValue":t[2]||(t[2]=s=>d.modifyOrder.is_paid=s)},oe,512),[[S,d.modifyOrder.is_paid]])])])]),de,le,e("div",ie,[e("div",re,[e("div",ae,[ne,_(e("input",{id:"orderName",type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>d.modifyOrder.user.name=s)},null,512),[[h,d.modifyOrder.user.name]])])]),e("div",ce,[e("div",_e,[he,_(e("input",{id:"orderTel",type:"tel",class:"form-control",onkeyup:"value=value.replace(/[^\\d]/g,'') ","onUpdate:modelValue":t[4]||(t[4]=s=>d.modifyOrder.user.tel=s)},null,512),[[h,d.modifyOrder.user.tel]])])]),e("div",me,[e("div",ue,[pe,_(e("input",{id:"Email",type:"email",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=s=>d.modifyOrder.user.email=s)},null,512),[[h,d.modifyOrder.user.email]])])]),e("div",be,[e("div",ge,[fe,_(e("input",{id:"orderAddress",type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=s=>d.modifyOrder.user.address=s)},null,512),[[h,d.modifyOrder.user.address]])])]),e("div",Oe,[e("div",ve,[ye,_(e("textarea",{id:"orderMessage",type:"text",class:"form-control",rows:"4","onUpdate:modelValue":t[7]||(t[7]=s=>d.modifyOrder.message=s)},`\r
                `,512),[[h,d.modifyOrder.message]])])])]),Me,xe,e("div",we,[e("div",Pe,[e("table",$e,[Ae,e("tbody",null,[(l(!0),i(f,null,M(d.modifyOrder.products,s=>(l(),i("tr",{key:s.id},[e("td",null,n(s.product.category),1),e("td",Ee,n(s.product.title),1),e("td",Ie,[s.coupon?(l(),i("span",ke,n(s.coupon.title),1)):(l(),i("span",Se,"無使用"))]),e("td",Ce,n(s.qty),1),e("td",Ve,n(s.final_total),1)]))),128))])])]),e("p",Le,"訂單總金額 : "+n(d.modifyOrder.total),1)]),e("div",Te,[Ue,e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=s=>a.updateOrder())},"確認修改")])])):C("",!0)])])],512)}const Re=O(D,[["render",De]]),{VITE_APP_URL:w,VITE_APP_PATH:P}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"peihanwang-hexschool",BASE_URL:"/Fangsis/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},He={data(){return{deleteOrderModal:{}}},props:["tempOrder","deleteModalIsShow","closeModal","getOrders"],watch:{deleteModalIsShow(){this.deleteModalIsShow&&this.deleteOrderModal.show()}},methods:{deleteOrder(){this.$http.delete(`${w}/v2/api/${P}/admin/order/${this.tempOrder.id}`).then(o=>{this.getOrders(),this.deleteOrderModal.hide(),alert(o.data.message)}).catch(o=>{alert(o.data.message)})},deleteAllOrder(){this.$http.delete(`${w}/v2/api/${P}/admin/orders/all`).then(o=>{this.getOrders(),this.deleteOrderModal.hide(),alert(o.data.message)}).catch(o=>{alert(o.data.message)})}},mounted(){this.deleteOrderModal=new $(this.$refs.deleteOrderModal),this.$refs.deleteOrderModal.addEventListener("hidden.bs.modal",o=>{this.closeModal("delete")})}},Ne={id:"deleteOrderModal",ref:"deleteOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"deleteOrderModal","aria-hidden":"true"},Be={class:"modal-dialog"},Fe={class:"modal-content border-0"},je=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Je={class:"modal-body"},qe={class:"text-danger"},ze={class:"modal-footer"},Ge=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ke(o,t,r,v,d,a){return l(),i("div",Ne,[e("div",Be,[e("div",Fe,[je,e("div",Je,[u(" 是否刪除 "),e("strong",qe,n(r.tempOrder.id),1),u(" 訂單 ( 刪除後將無法恢復 )。 ")]),e("div",ze,[Ge,r.tempOrder.id==="全部"?(l(),i("button",{key:0,type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=s=>a.deleteAllOrder())}," 確認刪除 ")):(l(),i("button",{key:1,type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=s=>a.deleteOrder())}," 確認刪除 "))])])])],512)}const Qe=O(He,[["render",Ke]]),We={data(){return{}},props:["pages","getOrders"]},Xe={"aria-label":"Page navigation example"},Ye={class:"pagination"},Ze=e("span",{"aria-hidden":"true"},"«",-1),et=[Ze],tt=["onClick"],st=e("span",{"aria-hidden":"true"},"»",-1),ot=[st];function dt(o,t,r,v,d,a){return l(),i("nav",Xe,[e("ul",Ye,[e("li",{class:b(["page-item",{disabled:!r.pages.has_pre}])},[e("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=g(s=>r.getOrders(r.pages.current_page-1),["prevent"]))},et)],2),(l(!0),i(f,null,M(r.pages.total_pages,s=>(l(),i("li",{class:b(["page-item",{active:s===r.pages.current_page}]),key:s+"page"},[e("a",{class:"page-link",href:"#",onClick:g(x=>r.getOrders(s),["prevent"])},n(s),9,tt)],2))),128)),e("li",{class:b(["page-item",{disabled:!r.pages.has_next}])},[e("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=g(s=>r.getOrders(r.pages.current_page+1),["prevent"]))},ot)],2)])])}const lt=O(We,[["render",dt]]),{VITE_APP_URL:it,VITE_APP_PATH:rt}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"peihanwang-hexschool",BASE_URL:"/Fangsis/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},at={data(){return{orders:[],tempOrder:{},pages:{},editModalIsShow:!1,deleteModalIsShow:!1,container:this.$refs.orderLoadingContainer}},components:{OrderEditModal:Re,OrderDeleteModal:Qe,OrderPagination:lt,AdminContainerLoading:V},mixins:[L],methods:{getOrders(o=1){this.isLoading=!0,this.$http.get(`${it}/v2/api/${rt}/admin/orders?page=${o}`).then(t=>{this.orders=t.data.orders,this.pages=t.data.pagination,this.isLoading=!1}).catch(t=>{alert(t.data.message),this.isLoading=!1})},openModal(o,t){o==="edit"?(this.editModalIsShow=!0,this.tempOrder={...t}):o==="delete"?(this.deleteModalIsShow=!0,this.tempOrder={...t}):o==="deleteAll"&&(this.deleteModalIsShow=!0,this.tempOrder={id:"全部"})},closeModal(o){o==="edit"?this.editModalIsShow=!1:o==="delete"&&(this.deleteModalIsShow=!1)}},mounted(){this.getOrders()}},nt={class:"d-flex"},ct={class:"sidebar bg-primary",style:{"min-height":"110vh"}},_t=e("h2",{class:"fs-5 text-white py-3 px-3"},"Fangsis 後台管理系統",-1),ht={class:"list-group rounded-0"},mt=e("i",{class:"bi bi-box-seam-fill me-2"},null,-1),ut=e("i",{class:"bi bi-box-seam-fill me-2"},null,-1),pt=e("i",{class:"bi bi-box-seam-fill me-2"},null,-1),bt={class:"main"},gt={class:"bg-white border-bottom w-100 d-flex justify-content-between"},ft=e("i",{class:"bi bi-arrows-angle-expand"},null,-1),Ot=[ft],vt=e("i",{class:"bi bi-door-open me-2"},null,-1),yt={class:"container py-4 px-4"},Mt={class:"border rounded d-flex justify-content-between py-5 px-4 mb-3"},xt=e("h3",null,"訂單管理",-1),wt={class:"border rounded py-5 px-4 mb-5 d-flex flex-column"},Pt={class:"vl-parent",ref:"orderLoadingContainer"},$t={class:"table-responsive mb-3"},At={class:"table"},Et=e("thead",null,[e("tr",{class:"text-nowrap"},[e("th",{scope:"col",class:"text-break"},"訂單編號"),e("th",{scope:"col"},"付款狀態"),e("th",{scope:"col"},"訂購人姓名"),e("th",{scope:"col"},"連絡電話"),e("th",{scope:"col"},"聯絡信箱"),e("th",{scope:"col"},"收件地址"),e("th",{scope:"col"},"訂單成立時間"),e("th",{scope:"col"},"編輯資料")])],-1),It={key:0,class:"text-success"},kt={key:1,class:"text-danger"},St={class:"btn-group text-nowrap"},Ct=["onClick"],Vt=["onClick"],Lt={class:"d-flex justify-content-center"};function Tt(o,t,r,v,d,a){const s=p("router-link"),x=p("AdminContainerLoading"),A=p("OrderPagination"),E=p("OrderEditModal"),I=p("OrderDeleteModal");return l(),i(f,null,[e("div",{class:b({"sidebar-toggled":o.sidebarToggledStatus})},[e("div",nt,[e("aside",ct,[_t,e("div",ht,[m(s,{to:"/admin/AdminProducts",class:"list-group-item bg-primary link-light border-0"},{default:y(()=>[mt,u("產品管理 ")]),_:1}),m(s,{to:"/admin/AdminOrders",class:"list-group-item list-group-item-active bg-primary link-light border-0"},{default:y(()=>[ut,u("訂單管理 ")]),_:1}),m(s,{to:"/admin/AdminCoupons",class:"list-group-item bg-primary link-light border-0"},{default:y(()=>[pt,u("優惠卷管理 ")]),_:1})])]),e("main",bt,[e("div",gt,[e("a",{onClick:t[0]||(t[0]=g(c=>o.sidebarToggled(),["prevent"])),href:"",class:"py-3 px-4 d-inline-block border-end"},Ot),e("button",{onClick:t[1]||(t[1]=c=>o.adminLogout()),class:"btn btn-primary text-end my-2 me-3"},[vt,u("登出 ")])]),e("div",yt,[e("div",Mt,[xt,e("button",{class:"btn btn-outline-primary",onClick:t[2]||(t[2]=c=>a.openModal("deleteAll")),type:"button"}," 刪除全部訂單 ")]),e("div",wt,[e("div",Pt,[m(x,{isLoading:o.isLoading,container:d.container},null,8,["isLoading","container"]),e("div",$t,[e("table",At,[Et,e("tbody",null,[(l(!0),i(f,null,M(d.orders,c=>(l(),i("tr",{key:c.id},[e("td",null,n(c.id),1),e("td",null,[c.is_paid?(l(),i("span",It,"已付款")):(l(),i("span",kt,"未付款"))]),e("td",null,n(c.user.name),1),e("td",null,n(c.user.tel),1),e("td",null,n(c.user.email),1),e("td",null,n(c.user.address),1),e("td",null,n(new Date(c.create_at*1e3).toLocaleString()),1),e("td",null,[e("div",St,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:k=>a.openModal("edit",c)}," 編輯 ",8,Ct),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:k=>a.openModal("delete",c)}," 刪除 ",8,Vt)])])]))),128))])])]),e("div",Lt,[m(A,{pages:d.pages,getOrders:a.getOrders},null,8,["pages","getOrders"])])],512)])])])])],2),m(E,{tempOrder:d.tempOrder,editModalIsShow:d.editModalIsShow,closeModal:a.closeModal,getOrders:a.getOrders},null,8,["tempOrder","editModalIsShow","closeModal","getOrders"]),m(I,{tempOrder:d.tempOrder,deleteModalIsShow:d.deleteModalIsShow,closeModal:a.closeModal,getOrders:a.getOrders},null,8,["tempOrder","deleteModalIsShow","closeModal","getOrders"])],64)}const Nt=O(at,[["render",Tt]]);export{Nt as default};
