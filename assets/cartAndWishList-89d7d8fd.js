import{f as u,H as r}from"./index-fc8d9e33.js";import{S as e}from"./sweetalert2.all-4f24a9ab.js";import{T as n}from"./index-a8802e03.js";const{VITE_APP_URL:l,VITE_APP_PATH:c}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"peihanwang-hexschool",BASE_URL:"/Fangsis/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},m=u("cartAndWishList",{state:()=>({wishList:[],wishListAddStatus:!0,carts:[],total:0,final_total:0,delivery:"順豐速遞 - 常溫配送",payment:"",couponCodeMessage:"",isLoading:!1,cartOffcanvasIsLoading:!1,spinnerLoading:""}),actions:{addWishList(t){const i={title:t.title,id:t.id,price:t.price,imageUrl:t.imageUrl,quantity:t.quantity,is_enabled:t.is_enabled};this.wishList.forEach((s,a)=>{s.id===i.id&&(this.wishList.splice(a,1),this.wishListAddStatus=!1,n.fire({icon:"success",title:"成功將產品從願望清單移除"}))}),this.wishListAddStatus===!0&&(this.wishList.push(i),n.fire({icon:"success",title:"成功將產品加入願望清單"})),this.wishListAddStatus=!0;const o=JSON.stringify(this.wishList);localStorage.setItem("localStorageWishList",o)},pullLocalStorageToWishList(){localStorage.key("localStorageWishList")!==null&&(this.wishList=JSON.parse(localStorage.getItem("localStorageWishList")))},removeWishListProduct(t){this.isLoading=!0,e.fire({text:"你確定要將商品從願望清單刪除嗎?",icon:"question",iconColor:"#5D7067",showCancelButton:!0,confirmButtonText:"確定",confirmButtonColor:"#5D7067",cancelButtonText:"取消",cancelButtonColor:"#DC3545",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0",cancelButton:"radius0"}}).then(i=>{i.isConfirmed&&(this.wishList.forEach((o,s)=>{o.id===t.id&&this.wishList.splice(s,1);const a=JSON.stringify(this.wishList);localStorage.setItem("localStorageWishList",a)}),n.fire({icon:"success",title:"成功將產品從願望清單移除"}),this.isLoading=!1)}),this.isLoading=!1},wishListActive(t){let i=!1;return this.wishList.forEach(o=>{t.id===o.id&&(i=!0)}),i},getCart(){this.isLoading=!0,r.get(`${l}/v2/api/${c}/cart`).then(t=>{this.carts=t.data.data.carts,this.total=t.data.data.total,this.final_total=t.data.data.final_total,this.isLoading=!1}).catch(()=>{e.fire({title:"連線失敗",text:"無法取得購物車資料，請重新確認網路連線並再次嘗試!",icon:"error",confirmButtonText:"關閉",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}}),this.isLoading=!1})},addToCart(t,i=1){if(this.isLoading=!0,this.spinnerLoading=t,i==="數量選擇"){e.fire({icon:"error",title:"產品數量未選擇",text:"請先選擇產品數量!",confirmButtonColor:"#5D7067",confirmButtonText:"關閉",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}}),this.spinnerLoading="";return}const o=Number(i),s={product_id:t,qty:o};r.post(`${l}/v2/api/${c}/cart`,{data:s}).then(()=>{this.getCart(),n.fire({icon:"success",title:"成功將產品加入購物車"}),this.isLoading=!1,this.spinnerLoading=""}).catch(()=>{e.fire({title:"連線失敗",text:"無法將產品加入購物車清單，請重新確認網路連線並再次嘗試!",icon:"error",confirmButtonText:"關閉",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}}),this.isLoading=!1,this.spinnerLoading=""})},removeCartProduct(t){this.cartOffcanvasIsLoading=!0,e.fire({text:"你確定要將該項產品從購物車刪除嗎?",icon:"question",iconColor:"#5D7067",showCancelButton:!0,confirmButtonText:"確定",confirmButtonColor:"#5D7067",cancelButtonText:"取消",cancelButtonColor:"#DC3545",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0",cancelButton:"radius0"}}).then(i=>{i.isConfirmed&&r.delete(`${l}/v2/api/${c}/cart/${t}`).then(()=>{this.getCart(),n.fire({icon:"success",title:"成功將產品從購物車移除"}),this.cartOffcanvasIsLoading=!1}).catch(()=>{e.fire({title:"連線失敗",text:"無法正確刪除產品資料，請重新確認網路連線並再次嘗試!",icon:"error",confirmButtonText:"關閉",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}}),this.cartOffcanvasIsLoading=!1}),this.cartOffcanvasIsLoading=!1})},removeCartAllProduct(){e.fire({title:"清空購物車",text:"您確定要清空購物車內的所有產品嗎?",icon:"question",iconColor:"#5D7067",showCancelButton:!0,confirmButtonText:"確定",confirmButtonColor:"#5D7067",cancelButtonText:"取消",cancelButtonColor:"#DC3545",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0",cancelButton:"radius0"}}).then(t=>{t.isConfirmed&&r.delete(`${l}/v2/api/${c}/carts`).then(()=>{this.getCart(),n.fire({icon:"success",title:"已清空您的購物車"})}).catch(()=>{e.fire({title:"連線失敗",text:"無法清空購物車資料，請重新確認網路連線並再次嘗試!",icon:"error",confirmButtonText:"關閉",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}})})})},upDataCartProduct(t,i){const o=Number(i);if(o<1){e.fire({title:"更新失敗",text:"產品數量不得少於 1 ",icon:"error",confirmButtonText:"確定",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}}).then(a=>{a.isConfirmed&&location.reload()});return}const s={productId:t,qty:o};r.put(`${l}/v2/api/${c}/cart/${t}`,{data:s}).then(()=>{this.getCart(),n.fire({icon:"success",title:"已成功更新產品數量"})}).catch(()=>{e.fire({title:"連線失敗",text:"無法更新購物車資料，請重新確認網路連線並再次嘗試!",icon:"error",confirmButtonText:"關閉",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}})})},UseCoupon(t){if(t==="")return;const o={code:t.trim()};r.post(`${l}/v2/api/${c}/coupon`,{data:o}).then(s=>{e.fire({title:"成功使用優惠劵",text:s.data.message,icon:"success",confirmButtonText:"確定",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}}),this.couponCodeMessage=`( ${s.data.message} )`;const a=JSON.stringify(this.couponCodeMessage);localStorage.setItem("localStorageCouponCodeMessage",a),this.getCart()}).catch(()=>{e.fire({title:"資料錯誤",text:"你所輸入的優惠券並不存在或是已經過期!",icon:"error",confirmButtonText:"確定",confirmButtonColor:"#5D7067",customClass:{title:"titleFontStyle",popup:"radius0",confirmButton:"radius0"}})})},deliveryMethod(t){this.delivery=t},paymentMethod(t){this.payment=t},paymentReset(){this.payment=""}},getters:{pullLocalStorage(){localStorage.key("localStorageWishList")!==null&&(this.wishList=JSON.parse(localStorage.getItem("localStorageWishList")))},pullLocalStorageGetCouponCodeMessage(){localStorage.key("localStorageCouponCodeMessage")!==null&&(this.couponCodeMessage=JSON.parse(localStorage.getItem("localStorageCouponCodeMessage")))}}});export{m as c};
